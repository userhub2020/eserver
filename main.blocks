<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="KYtR3#i6wFco6wtK#A0I">clients</variable><variable id="RdFX-u!kmthc:eelu!_N">client</variable><variable id="$zlY6u3x*rWr)h3E=i3i">n</variable><variable id="$s,5//$BfVCWdo;k_qU_">client2</variable><variable id=")Va3NuA.N1-*wtFr5$WC">serialNumber</variable><variable id="v;6a|:rWl7y^|8KYgijd">client3</variable><variable id="GdY+!h_x%s@T4TJ^-~S!">now</variable><variable id="/vcmxot(K(H/;e$ooG|.">client4</variable><variable id="^iio_TN^vdDL~}X]:CNc">lastPing</variable><variable id="V@4pZ4?dmYBE8Ay^P8l:">deadPing</variable><variable id="VI5.d`Xddh8OOeUrB6Lq">lostPing</variable></variables><block type="argument_reporter_number" id="Rk=OKXwei!tFL2gCQiGC" disabled="true" x="0" y="0"><field name="VALUE">id</field></block><block type="pxt-on-start" id="jKRc/`q9FqwBgC7@Z=RE" x="20" y="20"><statement name="HANDLER"><block type="variables_set" id="rq(?4k})0E7-;ymM4P^P"><field name="VAR" id="V@4pZ4?dmYBE8Ay^P8l:">deadPing</field><comment pinned="false" h="80" w="160">Radio monitoring dashboard

Each radio client is represented by a dot on the screen.
Once a client is registered, it will stay at the same pixel location
forever.

Radio clients can simply send a number (between 0..255) on group 4.
They must transmit the serial number using ``radio.setTransmitSerialNumber(true)``

The received number is used to set the LED brightness for that client.

If the radio packet is not received for 10sec, the LED starts blinking.</comment><value name="VALUE"><shadow type="math_number" id="{7;%E`18aqoNX`{X;3-T"><field name="NUM">20000</field></shadow></value><next><block type="variables_set" id="}VY9nh?GWRhXZ_y(pH7|"><field name="VAR" id="VI5.d`Xddh8OOeUrB6Lq">lostPing</field><value name="VALUE"><shadow type="math_number" id="RGxRX].@,=Ox%2Nljq/h"><field name="NUM">10000</field></shadow></value><next><block type="typescript_statement" id="pA*XdF*@NbDyM@ItaeBe" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="interface Client {" line1="    // client serial id" line2="    id: number;" line3="    // sprite on screen" line4="    sprite: game.LedSprite;" line5="    // last ping received" line6="    ping: number;" line7="}" numlines="8"></mutation></block></next></block></next></block></statement></block><block type="argument_reporter_number" id="4HbHa;/_gn!W(bh:znOk" disabled="true" x="385" y="20"><field name="VALUE">id</field></block><block type="device_forever" id="iXLdR{1NLgnvTv~ySM#[" x="478" y="20"><comment pinned="false" h="80" w="160">monitor the sprites and start blinking when no packet is received</comment><statement name="HANDLER"><block type="variables_set" id="9+B0mcQH(a8~|TuNb/hP"><field name="VAR" id="GdY+!h_x%s@T4TJ^-~S!">now</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="device_get_running_time" id=")}$Tb:[sS+:zhr7Pxj/S"></block></value><next><block type="pxt_controls_for_of" id="bNk{z{B:^@fvcEKjo.kX"><value name="VAR"><shadow type="variables_get_reporter" id=".ryyv`3VnzE2;D|a}O?4"><field name="VAR" id="/vcmxot(K(H/;e$ooG|.">client4</field></shadow></value><value name="LIST"><block type="variables_get" id="b,E#L9wieOhgsv%=$Vjl"><field name="VAR" id="KYtR3#i6wFco6wtK#A0I">clients</field></block></value><statement name="DO"><block type="variables_set" id="q+{.7u)fXm0T.Ir}w^sC"><field name="VAR" id="^iio_TN^vdDL~}X]:CNc">lastPing</field><comment pinned="false" h="80" w="160">lost signal starts blinking</comment><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="bQcK)-gFnrA!KgH$Fl_A"><field name="OP">MINUS</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="=]o#Kyxu^PC7GUG/RMG)"><field name="VAR" id="GdY+!h_x%s@T4TJ^-~S!">now</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="B?vT+FVK@[g2}RM#/[C{" editable="false"><field name="EXPRESSION">client4.ping</field></block></value></block></value><next><block type="controls_if" id="h=oGw^:zrI?U?.{(Tf%P"><mutation elseif="1" else="1"></mutation><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id=":[!B]e{lVHGN~!9HnHug"><field name="OP">GT</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="ENxr2vKzhS@{HBJHZAq9"><field name="VAR" id="^iio_TN^vdDL~}X]:CNc">lastPing</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="rl.!UNCnST*-U/hI%e{c"><field name="VAR" id="V@4pZ4?dmYBE8Ay^P8l:">deadPing</field></block></value></block></value><statement name="DO0"><block type="typescript_statement" id="gG@0zM,)FB`+]eOsB*6o" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="client4.sprite.setBlink(0)" numlines="1"></mutation><next><block type="typescript_statement" id="R}@Eo2HYfxm[lLDkOU4-" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="client4.sprite.setBrightness(0)" numlines="1"></mutation></block></next></block></statement><value name="IF1"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="lUNlNVw|PzLSnw*wq^=%"><field name="OP">GT</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="53-g)`4Bf;X4s20H`b}W"><field name="VAR" id="^iio_TN^vdDL~}X]:CNc">lastPing</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="H6}5-}Y|G5_R$ubcv;4C"><field name="VAR" id="VI5.d`Xddh8OOeUrB6Lq">lostPing</field></block></value></block></value><statement name="DO1"><block type="typescript_statement" id="irkEB8Hb@Ppd%R(HBd*@" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="client4.sprite.setBlink(500);" numlines="1"></mutation></block></statement><statement name="ELSE"><block type="typescript_statement" id="n^{Ty2$E_*zAKMKpp/.J" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="client4.sprite.setBlink(0);" numlines="1"></mutation></block></statement></block></next></block></statement><next><block type="device_pause" id="G~Bdot.m9ZAu0u-7OCuc"><value name="pause"><shadow type="timePicker" id="*:3+G1aAc)vl!{wzy+:V"><field name="ms">500</field></shadow></value></block></next></block></next></block></statement></block><block type="radio_on_number_drag" id="2{~,7IeOUS1-vjUU=?T8" x="1095" y="20"><comment pinned="false" h="80" w="160">store data received by clients</comment><value name="HANDLER_DRAG_PARAM_receivedNumber"><shadow type="argument_reporter_number" id="EXc:b6#Ornt%y8Fiax=V"><field name="VALUE">receivedNumber</field></shadow></value><statement name="HANDLER"><block type="variables_set" id="M%A{,`2E*Cbc)1}|%jbH"><field name="VAR" id=")Va3NuA.N1-*wtFr5$WC">serialNumber</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="radio_received_packet" id="Z9EUoC5Fg}mzt$J,(b64"><value name="type"><shadow type="radio_packet_property" id=":VR?coc.suw6L-C[veO;"><field name="note">RadioPacketProperty.SerialNumber</field></shadow></value></block></value><next><block type="variables_set" id="ZqU%:yrl[SKx7Cm*eX`+"><field name="VAR" id="v;6a|:rWl7y^|8KYgijd">client3</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="function_call_output" id="!uXqUF#0i52C-{{O_^%y"><mutation name="getClient" functionid="}v4uSgX2Gmi$NX,FKbj}"><arg name="id" id="sp1gzcnkko16jzapcp9od" type="number"></arg></mutation><value name="sp1gzcnkko16jzapcp9od"><shadow type="math_number"><field name="NUM">1</field></shadow><block type="variables_get" id="#CkuMJDTAhgN%3q]PQir"><field name="VAR" id=")Va3NuA.N1-*wtFr5$WC">serialNumber</field></block></value></block></value><next><block type="controls_if" id="!XGAY^860k!;:V?I1pK:"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_negate" id="]8G*uzrrW-lfN2t9Ow+#"><value name="BOOL"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="variables_get" id="aMH[0upnTg:GP94lkKmA"><field name="VAR" id="v;6a|:rWl7y^|8KYgijd">client3</field></block></value></block></value><statement name="DO0"><block type="typescript_statement" id="e=OSEJlO~W#T=2F,:2Qq" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="return;" numlines="1"></mutation></block></statement><next><block type="typescript_statement" id="]erdT3`;}x8KSLE3nM]G" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="client3.ping = input.runningTime()" numlines="1"></mutation><next><block type="typescript_statement" id="Rx)H)+}4WLDq(C.k?~J4" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="client3.sprite.setBrightness(Math.max(1, receivedNumber &amp; 0xff));" numlines="1"></mutation></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="|,#XV`^/E3HV50-=(8g*" x="1796" y="20"><mutation name="getClient" functionid="}v4uSgX2Gmi$NX,FKbj}"><arg name="id" id="sp1gzcnkko16jzapcp9od" type="number"></arg></mutation><field name="function_name">getClient</field><comment pinned="false" h="80" w="160">lazy allocate sprite</comment><value name="sp1gzcnkko16jzapcp9od"><shadow type="argument_reporter_number" id="e-?2WM{HBw#21?HOCMyK"><field name="VALUE">id</field></shadow></value><statement name="STACK"><block type="controls_if" id="IQcEtNt)yJbynmuj%H.Z"><comment pinned="false" h="80" w="160">needs an id to track radio client's identity</comment><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_negate" id="[W_!|O)tAdwC:K2aPS4W"><value name="BOOL"><shadow type="logic_boolean" id="aK2aK6/3W_]Qyromg/sk"><field name="BOOL">TRUE</field></shadow></value></block></value><statement name="DO0"><block type="function_return" id=",J=gba)2rIZGQQpQuOA2"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="rT_WlKl0._bm*@w=}#*~" editable="false"><field name="EXPRESSION">undefined</field></block></value></block></statement><next><block type="pxt_controls_for_of" id="4thEZpqT#c{OnAZ*YirY"><comment pinned="false" h="80" w="160">look for cached clients</comment><value name="VAR"><shadow type="variables_get_reporter" id="R1`u:0_Dy{TxINSUsADr"><field name="VAR" id="RdFX-u!kmthc:eelu!_N">client</field></shadow></value><value name="LIST"><block type="variables_get" id="|(eX?-WMF0EVX$/GN~1f"><field name="VAR" id="KYtR3#i6wFco6wtK#A0I">clients</field></block></value><statement name="DO"><block type="controls_if" id=")DYg[/A+;jJhWvS`u9+,"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="lHk[84+;zx,WysXQA+g+"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="+^Vg_`WbV]EwtS3Z8}X:" editable="false"><field name="EXPRESSION">client.id</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="E-5ujCwKI_9qx/EU{Z%Z"><field name="VALUE">id</field></block></value></block></value><statement name="DO0"><block type="function_return" id="5u*1I5|?EG5?bgo2KyN/"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="(]L@3KCH457Xtv~w$SL?"><field name="VAR" id="RdFX-u!kmthc:eelu!_N">client</field></block></value></block></statement></block></statement><next><block type="variables_set" id="S96Ui-IPQlHK`wwc0(GP"><field name="VAR" id="$zlY6u3x*rWr)h3E=i3i">n</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="lists_length" id="~!4Tr}{D}lXRqHTsfrmr"><value name="VALUE"><block type="variables_get" id="`hD(RhfNh41}=_!Ya)f^"><field name="VAR" id="KYtR3#i6wFco6wtK#A0I">clients</field></block></value></block></value><next><block type="controls_if" id="`t4^43[q|v*EmD/tsy(e"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="6XA~p%j{;DXy~j}rG((p"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="#IFB9+or~eHUkRm==TFz"><field name="VAR" id="$zlY6u3x*rWr)h3E=i3i">n</field></block></value><value name="B"><shadow type="math_number" id="kNMDpv|j/yRK;Z)BKdDY"><field name="NUM">24</field></shadow></value></block></value><statement name="DO0"><block type="function_return" id="_.LLgpQvbZ`KRA+E_CW/"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><comment pinned="false" h="80" w="160">out of pixels</comment><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="!LBPk?^,t^rdlx3r+q:i" editable="false"><field name="EXPRESSION">undefined</field></block></value></block></statement><next><block type="typescript_statement" id="zhWV9v}//-,eXu*R?Jbm" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="const client2: Client = {" line1="        id: id," line2="        sprite: game.createSprite(n % 5, n / 5)," line3="        ping: input.runningTime()" line4="    }" numlines="5" declaredvars="client2"></mutation><next><block type="array_push" id="F[0dtyiwW6H[^iD1!Abo"><value name="list"><block type="variables_get" id="s`SLFH27B38wjcsE:;f^"><field name="VAR" id="KYtR3#i6wFco6wtK#A0I">clients</field></block></value><value name="value"><block type="variables_get" id="(H?%7I}k[rm[#{Ng6V46"><field name="VAR" id="$s,5//$BfVCWdo;k_qU_">client2</field></block></value><next><block type="function_return" id="UHdO}NR-r_r=~j?TLMRn"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="|tqHEG#K2myq}t][8z;y"><field name="VAR" id="$s,5//$BfVCWdo;k_qU_">client2</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>